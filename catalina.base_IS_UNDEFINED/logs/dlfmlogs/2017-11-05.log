2017-11-05 21:18:40.948 [main] INFO  o.s.t.c.support.DefaultTestContextBootstrapper - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2017-11-05 21:18:40.999 [main] INFO  o.s.t.c.support.DefaultTestContextBootstrapper - Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@4e41089d, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@32a068d1, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@33cb5951, org.springframework.test.context.support.DirtiesContextTestExecutionListener@365c30cc, org.springframework.test.context.transaction.TransactionalTestExecutionListener@701fc37a, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@4148db48]
2017-11-05 21:18:41.156 [main] INFO  o.s.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from class path resource [applicationContext.xml]
2017-11-05 21:18:42.194 [main] INFO  o.s.context.support.GenericApplicationContext - Refreshing org.springframework.context.support.GenericApplicationContext@7bb58ca3: startup date [Sun Nov 05 21:18:42 CST 2017]; root of context hierarchy
2017-11-05 21:18:43.857 [main] INFO  org.hibernate.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {4.0.2.Final}
2017-11-05 21:18:43.879 [main] INFO  org.hibernate.Version - HHH000412: Hibernate Core {4.2.14.Final}
2017-11-05 21:18:43.883 [main] INFO  org.hibernate.cfg.Environment - HHH000206: hibernate.properties not found
2017-11-05 21:18:43.886 [main] INFO  org.hibernate.cfg.Environment - HHH000021: Bytecode provider name : javassist
2017-11-05 21:18:45.072 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2017-11-05 21:18:45.084 [main] INFO  o.hibernate.engine.jdbc.internal.LobCreatorBuilder - HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2017-11-05 21:18:45.379 [main] INFO  o.h.e.t.internal.TransactionFactoryInitiator - HHH000399: Using default transaction strategy (direct JDBC transactions)
2017-11-05 21:18:45.389 [main] INFO  o.h.hql.internal.ast.ASTQueryTranslatorFactory - HHH000397: Using ASTQueryTranslatorFactory
2017-11-05 21:18:45.391 [main] WARN  org.hibernate.cfg.SettingsFactory - Unrecognized value for "hibernate.hbm2ddl.auto": none
2017-11-05 21:18:45.497 [main] INFO  org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 4.3.1.Final
2017-11-05 21:18:47.811 [main] DEBUG org.hibernate.SQL - 
    select
        z.id as id,
        z.realname as name,
        z.userType,
        z.sex,
        z.finishTime,
        z.statu,
        z.score,
        z.completeness 
    from
        (   SELECT
            b.`id` as id,
            a.`realname`,
            CASE a.`user_type` 
                WHEN 0 THEN '学生' 
                WHEN 1 THEN '老师' 
                ELSE '家长' 
            END AS userType,
            CASE a.`sex`  
                WHEN 0 THEN '女' 
                WHEN 1 THEN '男' 
                ELSE ' ' 
            END AS sex,
            DATE_FORMAT(b.`survey_time`,
            '%Y-%m-%d %H:%i:%s') AS finishTime,
            CASE b.`status` 
                WHEN 1 THEN '有' 
                ELSE '无' 
            END AS statu,
            IFNULL(b.`score`,
            ' ') AS score,
            CONCAT(CAST((COUNT(DISTINCT d.`question_id`) / (SELECT
                COUNT(1) 
            FROM
                survey_question e 
            WHERE
                e.`survey_id`=c.`id` 
                AND e.`status`=1)) AS DECIMAL(5,
            2)) * 100,
            '%') AS completeness 
        FROM
            USER a  
        INNER JOIN
            survey_record b 
                ON a.`id`=b.`user_id` 
        INNER JOIN
            survey_record_detail d 
                ON b.`id`=d.`record_id` 
        INNER JOIN
            survey c 
                ON b.`survey_id`=c.`id` 
                AND a.`user_type`=c.`survey_type` 
        WHERE
            a.`status`=1 
            AND b.`status`=1 
            AND c.`id`=? 
            AND d.`answer_id` IS NOT NULL  
        GROUP BY
            a.`realname`,
            a.`user_type`,
            a.`sex`,
            b.`survey_time`,
            b.`status`,
            b.`score`,
            b.`id`) z 
        ORDER BY
            z.id  
2017-11-05 21:18:47.882 [main] TRACE org.hibernate.type.descriptor.sql.BasicBinder - binding parameter [1] as [INTEGER] - 4
2017-11-05 21:18:47.995 [main] INFO  com.sharewin.modules.sys.service.SurveyManager - 222
2017-11-05 21:18:48.171 [main] INFO  com.sharewin.xhmz.XhmzTest - [{"score":" ","finishTime":"2017-11-02 16:30:16","sex":"女","name":"周丽琴","id":5,"userType":"学生","statu":"有","completeness":"100.00%"},{"score":" ","finishTime":"2017-11-02 16:44:33","sex":"男","name":"姜晓峰","id":7,"userType":"学生","statu":"有","completeness":"100.00%"},{"score":" ","finishTime":"2017-11-02 16:45:16","sex":"男","name":"似懂非懂","id":8,"userType":"学生","statu":"有","completeness":"100.00%"},{"score":" ","finishTime":"2017-11-02 16:45:58","sex":" ","name":"张一鸣","id":9,"userType":"学生","statu":"有","completeness":"100.00%"}]
2017-11-05 21:18:48.201 [Thread-5] INFO  o.s.context.support.GenericApplicationContext - Closing org.springframework.context.support.GenericApplicationContext@7bb58ca3: startup date [Sun Nov 05 21:18:42 CST 2017]; root of context hierarchy
2017-11-05 21:37:22.880 [main] INFO  o.s.t.c.support.DefaultTestContextBootstrapper - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2017-11-05 21:37:22.905 [main] INFO  o.s.t.c.support.DefaultTestContextBootstrapper - Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@4e41089d, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@32a068d1, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@33cb5951, org.springframework.test.context.support.DirtiesContextTestExecutionListener@365c30cc, org.springframework.test.context.transaction.TransactionalTestExecutionListener@701fc37a, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@4148db48]
2017-11-05 21:37:23.061 [main] INFO  o.s.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from class path resource [applicationContext.xml]
2017-11-05 21:37:24.309 [main] INFO  o.s.context.support.GenericApplicationContext - Refreshing org.springframework.context.support.GenericApplicationContext@7bb58ca3: startup date [Sun Nov 05 21:37:24 CST 2017]; root of context hierarchy
2017-11-05 21:37:25.571 [main] INFO  org.hibernate.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {4.0.2.Final}
2017-11-05 21:37:25.579 [main] INFO  org.hibernate.Version - HHH000412: Hibernate Core {4.2.14.Final}
2017-11-05 21:37:25.582 [main] INFO  org.hibernate.cfg.Environment - HHH000206: hibernate.properties not found
2017-11-05 21:37:25.584 [main] INFO  org.hibernate.cfg.Environment - HHH000021: Bytecode provider name : javassist
2017-11-05 21:37:26.631 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2017-11-05 21:37:26.643 [main] INFO  o.hibernate.engine.jdbc.internal.LobCreatorBuilder - HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2017-11-05 21:37:26.915 [main] INFO  o.h.e.t.internal.TransactionFactoryInitiator - HHH000399: Using default transaction strategy (direct JDBC transactions)
2017-11-05 21:37:26.921 [main] INFO  o.h.hql.internal.ast.ASTQueryTranslatorFactory - HHH000397: Using ASTQueryTranslatorFactory
2017-11-05 21:37:26.923 [main] WARN  org.hibernate.cfg.SettingsFactory - Unrecognized value for "hibernate.hbm2ddl.auto": none
2017-11-05 21:37:26.978 [main] INFO  org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 4.3.1.Final
2017-11-05 21:37:28.934 [main] DEBUG org.hibernate.SQL - 
    select
        z.id as id,
        z.realname as name,
        z.userType,
        z.sex,
        z.finishTime,
        z.statu,
        z.score,
        z.completeness 
    from
        (   SELECT
            b.`id` as id,
            a.`realname`,
            CASE a.`user_type` 
                WHEN 0 THEN '学生' 
                WHEN 1 THEN '老师' 
                ELSE '家长' 
            END AS userType,
            CASE a.`sex`  
                WHEN 0 THEN '女' 
                WHEN 1 THEN '男' 
                ELSE ' ' 
            END AS sex,
            DATE_FORMAT(b.`survey_time`,
            '%Y-%m-%d %H:%i:%s') AS finishTime,
            CASE b.`status` 
                WHEN 1 THEN '有' 
                ELSE '无' 
            END AS statu,
            IFNULL(b.`score`,
            ' ') AS score,
            CONCAT(CAST((COUNT(DISTINCT d.`question_id`) / (SELECT
                COUNT(1) 
            FROM
                survey_question e 
            WHERE
                e.`survey_id`=c.`id` 
                AND e.`status`=1)) AS DECIMAL(5,
            2)) * 100,
            '%') AS completeness 
        FROM
            USER a  
        INNER JOIN
            survey_record b 
                ON a.`id`=b.`user_id` 
        INNER JOIN
            survey_record_detail d 
                ON b.`id`=d.`record_id` 
        INNER JOIN
            survey c 
                ON b.`survey_id`=c.`id` 
                AND a.`user_type`=c.`survey_type` 
        WHERE
            a.`status`=1 
            AND b.`status`=1 
            AND c.`id`=? 
            AND d.`answer_id` IS NOT NULL  
        GROUP BY
            a.`realname`,
            a.`user_type`,
            a.`sex`,
            b.`survey_time`,
            b.`status`,
            b.`score`,
            b.`id`) z 
        ORDER BY
            z.id  
2017-11-05 21:37:28.961 [main] TRACE org.hibernate.type.descriptor.sql.BasicBinder - binding parameter [1] as [INTEGER] - 4
2017-11-05 21:37:29.062 [main] INFO  com.sharewin.modules.sys.service.SurveyManager - 222
2017-11-05 21:37:29.232 [main] INFO  com.sharewin.xhmz.XhmzTest - [{"score":" ","finishTime":"2017-11-02 16:30:16","sex":"女","name":"周丽琴","id":5,"userType":"学生","statu":"有","completeness":"100.00%"},{"score":" ","finishTime":"2017-11-02 16:44:33","sex":"男","name":"姜晓峰","id":7,"userType":"学生","statu":"有","completeness":"100.00%"},{"score":" ","finishTime":"2017-11-02 16:45:16","sex":"男","name":"似懂非懂","id":8,"userType":"学生","statu":"有","completeness":"100.00%"},{"score":" ","finishTime":"2017-11-02 16:45:58","sex":" ","name":"张一鸣","id":9,"userType":"学生","statu":"有","completeness":"100.00%"}]
2017-11-05 21:37:29.236 [Thread-5] INFO  o.s.context.support.GenericApplicationContext - Closing org.springframework.context.support.GenericApplicationContext@7bb58ca3: startup date [Sun Nov 05 21:37:24 CST 2017]; root of context hierarchy
2017-11-05 21:42:49.619 [main] INFO  o.s.t.c.support.DefaultTestContextBootstrapper - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2017-11-05 21:42:49.649 [main] INFO  o.s.t.c.support.DefaultTestContextBootstrapper - Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@4e41089d, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@32a068d1, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@33cb5951, org.springframework.test.context.support.DirtiesContextTestExecutionListener@365c30cc, org.springframework.test.context.transaction.TransactionalTestExecutionListener@701fc37a, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@4148db48]
2017-11-05 21:42:50.140 [main] INFO  o.s.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from class path resource [applicationContext.xml]
2017-11-05 21:42:51.203 [main] INFO  o.s.context.support.GenericApplicationContext - Refreshing org.springframework.context.support.GenericApplicationContext@7bb58ca3: startup date [Sun Nov 05 21:42:51 CST 2017]; root of context hierarchy
2017-11-05 21:42:52.657 [main] INFO  org.hibernate.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {4.0.2.Final}
2017-11-05 21:42:52.665 [main] INFO  org.hibernate.Version - HHH000412: Hibernate Core {4.2.14.Final}
2017-11-05 21:42:52.668 [main] INFO  org.hibernate.cfg.Environment - HHH000206: hibernate.properties not found
2017-11-05 21:42:52.670 [main] INFO  org.hibernate.cfg.Environment - HHH000021: Bytecode provider name : javassist
2017-11-05 21:42:53.692 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2017-11-05 21:42:53.701 [main] INFO  o.hibernate.engine.jdbc.internal.LobCreatorBuilder - HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
2017-11-05 21:42:53.961 [main] INFO  o.h.e.t.internal.TransactionFactoryInitiator - HHH000399: Using default transaction strategy (direct JDBC transactions)
2017-11-05 21:42:53.969 [main] INFO  o.h.hql.internal.ast.ASTQueryTranslatorFactory - HHH000397: Using ASTQueryTranslatorFactory
2017-11-05 21:42:53.973 [main] WARN  org.hibernate.cfg.SettingsFactory - Unrecognized value for "hibernate.hbm2ddl.auto": none
2017-11-05 21:42:54.039 [main] INFO  org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 4.3.1.Final
2017-11-05 21:42:55.965 [main] DEBUG org.hibernate.SQL - 
    select
        z.realname as name,
        z.userType,
        z.sex,
        z.finishTime,
        z.statu,
        z.score,
        z.completeness 
    from
        (   SELECT
            b.`id` as id,
            a.`realname`,
            CASE a.`user_type` 
                WHEN 0 THEN '学生' 
                WHEN 1 THEN '老师' 
                ELSE '家长' 
            END AS userType,
            CASE a.`sex`  
                WHEN 0 THEN '女' 
                WHEN 1 THEN '男' 
                ELSE ' ' 
            END AS sex,
            DATE_FORMAT(b.`survey_time`,
            '%Y-%m-%d %H:%i:%s') AS finishTime,
            CASE b.`status` 
                WHEN 1 THEN '有' 
                ELSE '无' 
            END AS statu,
            IFNULL(b.`score`,
            ' ') AS score,
            CONCAT(CAST((COUNT(DISTINCT d.`question_id`) / (SELECT
                COUNT(1) 
            FROM
                survey_question e 
            WHERE
                e.`survey_id`=c.`id` 
                AND e.`status`=1)) AS DECIMAL(5,
            2)) * 100,
            '%') AS completeness 
        FROM
            USER a  
        INNER JOIN
            survey_record b 
                ON a.`id`=b.`user_id` 
        INNER JOIN
            survey_record_detail d 
                ON b.`id`=d.`record_id` 
        INNER JOIN
            survey c 
                ON b.`survey_id`=c.`id` 
                AND a.`user_type`=c.`survey_type` 
        WHERE
            a.`status`=1 
            AND b.`status`=1 
            AND c.`id`=? 
            AND d.`answer_id` IS NOT NULL  
        GROUP BY
            a.`realname`,
            a.`user_type`,
            a.`sex`,
            b.`survey_time`,
            b.`status`,
            b.`score`,
            b.`id`) z 
        ORDER BY
            z.id  
2017-11-05 21:42:55.997 [main] TRACE org.hibernate.type.descriptor.sql.BasicBinder - binding parameter [1] as [INTEGER] - 4
2017-11-05 21:42:56.095 [main] INFO  com.sharewin.modules.sys.service.SurveyManager - 222
2017-11-05 21:42:56.241 [main] INFO  com.sharewin.xhmz.XhmzTest - [{"score":" ","finishTime":"2017-11-02 16:30:16","sex":"女","name":"周丽琴","userType":"学生","statu":"有","completeness":"100.00%"},{"score":" ","finishTime":"2017-11-02 16:44:33","sex":"男","name":"姜晓峰","userType":"学生","statu":"有","completeness":"100.00%"},{"score":" ","finishTime":"2017-11-02 16:45:16","sex":"男","name":"似懂非懂","userType":"学生","statu":"有","completeness":"100.00%"},{"score":" ","finishTime":"2017-11-02 16:45:58","sex":" ","name":"张一鸣","userType":"学生","statu":"有","completeness":"100.00%"}]
2017-11-05 21:42:56.245 [Thread-5] INFO  o.s.context.support.GenericApplicationContext - Closing org.springframework.context.support.GenericApplicationContext@7bb58ca3: startup date [Sun Nov 05 21:42:51 CST 2017]; root of context hierarchy
